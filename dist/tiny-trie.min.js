!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.TinyTrie=t():e.TinyTrie=t()}(window,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=6)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TERMINAL="\0",t.TERMINUS=Object.create(null),t.VERSION=0,t.HEADER_WIDTH_FIELD=10,t.VERSION_FIELD=10,t.OFFSET_SIGN_FIELD=1,t.OFFSET_VAL_FIELD=21,t.CHAR_WIDTH_FIELD=8,t.POINTER_WIDTH_FIELD=8},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BASE64_INT_TO_CHAR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),t.BASE64_CHAR_TO_INT=t.BASE64_INT_TO_CHAR.reduce(function(e,t,r){return e[t]=r,e},{})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.floor_log2=function(e){for(var t=0;e>>=1;)t++;return t}},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),u=r(5),f=r(0),a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.root=t,this.frozen=!1}return i(e,[{key:"insert",value:function(e){if(this.frozen)throw new SyntaxError("Can't insert into frozen Trie");return e.split("").reduce(function(e,t){if(t===f.TERMINAL)throw new TypeError("Illegal string character "+f.TERMINAL);return e.hasOwnProperty(t)?e[t]:e[t]={}},this.root)[f.TERMINAL]=f.TERMINUS,this}},{key:"test",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{wildcard:null,prefix:!1},r=t.wildcard,n=t.prefix;if(!r){var i=this.root;return!!e.split("").every(function(e){return!!(i=i[e])})&&(n||i.hasOwnProperty(f.TERMINAL))}return!!this.search(e,{wildcard:r,prefix:n,first:!0})}},{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{wildcard:null,prefix:!1,first:!1},r=t.wildcard,i=t.prefix,o=t.first;if(r&&1!==r.length)throw new Error("Wildcard length must be 1; got "+r.length);for(var u=[],a=[{data:this.root,depth:0,memo:""}],c=e.length,s=function(){var t=a.shift();if(t.depth>=c){if(t.data.hasOwnProperty(f.TERMINAL)){if(o)return{v:t.memo};u.push(t.memo)}if(!i)return"continue"}var n=i&&t.depth>=c,s=e[t.depth];s===r||n?Object.keys(t.data).forEach(function(e){e!==f.TERMINAL&&a.push({data:t.data[e],depth:t.depth+1,memo:t.memo+e})}):t.data.hasOwnProperty(s)&&a.push({data:t.data[s],depth:t.depth+1,memo:t.memo+s})};a.length;){var l=s();switch(l){case"continue":continue;default:if("object"===(void 0===l?"undefined":n(l)))return l.v}}return o?null:u}},{key:"clone",value:function(){return new e(this.toJSON())}},{key:"freeze",value:function(){if(this.frozen)return this;for(var e={},t=this.root,r=[],n=[t];n.length;)t=n.pop(),Object.keys(t).forEach(function(e){if("_"!==e[1]){var i=t[e];r.push({current:i,char:e,parent:t}),n.push(i)}});for(var i=function(){var t=r.pop(),n=t.char,i=t.parent,o=t.current;if(e.hasOwnProperty(n)){var u=e[n],f=u.find(function(e){var t=Object.keys(e),r=Object.keys(o);return t.length===r.length&&t.every(function(t){return e[t]===o[t]})});f?i[n]=f:u.push(o)}else e[n]=[o]};r.length;)i();return this.frozen=!0,this}},{key:"encode",value:function(){for(var e=[],t=[this.root],r=new Set,n=Date.now(),i=1/0,a=-1/0,c=function(){var o=t.shift(),u=Object.keys(o).filter(function(e){return"_"!==e[1]}),f=u.length;o.__visited__=n;var c=o.__idx__=e.length;o.__parents__&&o.__parents__.forEach(function(e){var t=e.offset=c-e.idx;t<i&&(i=t),t>a&&(a=t)}),u.forEach(function(u,c){var s=o[u],l=e.length,_={char:u,idx:l,offset:null,last:c===f-1};if(s.__visited__===n){var h=s.__idx__,p=_.offset=h-l;p<i&&(i=p),p>a&&(a=p)}else s.__willVisit__===n?s.__parents__.push(_):(s.__willVisit__=n,s.__parents__=[_]),t.push(s);e.push(_),r.add(u)})};t.length;)c();var s,l,_,h=Array.from(r).filter(function(e){return e!==f.TERMINAL}),p=h.reduce(function(e,t,r){return e[t]=r+1,e},(s={},l=f.TERMINAL,_=0,l in s?Object.defineProperty(s,l,{value:_,enumerable:!0,configurable:!0,writable:!0}):s[l]=_,s)),d=o.floor_log2(h.length)+1,v=a-i,y=o.floor_log2(v)+1,E=new u.BinaryString;e.forEach(function(e){var t=e.char,r=e.offset,n=e.last;E.write(p[t],d),E.write(r-i,y),E.write(+n,1)}),E.flush();var I=new u.BinaryString,b=h.join(""),T=Math.ceil((f.HEADER_WIDTH_FIELD+f.VERSION_FIELD+f.OFFSET_SIGN_FIELD+f.OFFSET_VAL_FIELD+f.CHAR_WIDTH_FIELD+f.POINTER_WIDTH_FIELD)/6)+b.length,w=+(i<0);return I.write(T,f.HEADER_WIDTH_FIELD),I.write(f.VERSION,f.VERSION_FIELD),I.write(w,f.OFFSET_SIGN_FIELD),I.write(w?-i:i,f.OFFSET_VAL_FIELD),I.write(d,f.CHAR_WIDTH_FIELD),I.write(y,f.POINTER_WIDTH_FIELD),I.flush(),""+I.getData()+b+E.getData()}},{key:"toJSON",value:function(){var e=JSON.stringify(this.root,function(e,t){if("_"!==e[1])return t});return JSON.parse(e)}}]),e}();t.Trie=a},,function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(2),o=r(1),u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.buffer=0,this.pointer=0,this.data=""}return n(e,[{key:"write",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.buffer,n=t||i.floor_log2(e)+1;if(t&&e>=1<<t)throw new Error("Can't write "+e+" in only "+t+" bits");this.buffer=r<<n|e,this.pointer+=n,this._digest()}},{key:"flush",value:function(){for(var e=this.buffer,t=this.pointer;t&&t<6;)e<<=1,t+=1;this.pointer=t,this.buffer=e,this._digest()}},{key:"getData",value:function(){return this.flush(),this.data}},{key:"_digest",value:function(){for(var e=this.buffer,t=this.pointer,r="";t>=6;){var n=t-6,i=e>>n;e^=i<<n,t=n,r+=o.BASE64_INT_TO_CHAR[i]}this.pointer=t,this.buffer=e,this.data+=r}}]),e}();t.BinaryString=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=r(3);function o(e){var t=new n.Trie;return e.forEach(function(e){return t.insert(e)}),t}t.Trie=i.Trie,t.createSync=o,t.createFrozenSync=function(e){return o(e).freeze()}}])});